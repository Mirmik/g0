формат посылки:

8 длина поля адреса
v адрес приёмника
v адрес передатчика
v данные

по мере прохождения посылки по цепочке ретрансляторов,
ноды анализируют адресса, игнорируя поля, значение которых 
тождественно равно 
0 - ноль означает локальный нод. 
-1 - отсутствие необходимости ретрансляции.

Поля адреса следующего нода может быть произвольной длины в зависимости от ранга локальной сети ретранслятора.

по мере прохождения пакета ретрансляторы добавляют к полю адреса возврата адресс входной ноды.

пример.

адресация. Номер стаи. Номер особи. Номер нода.
Задача послать сообщение от лица правой лапы (нод 7) особи номер (1A7), являющейся членом стаи (2) левому усику (4) особи (3178), являющейся членом стаи (1).

правая лапа пересылает сообщение мозгу с адресом
01 3178 04 / 00 0000 00

мозг особи телепатически отправляет сообщение, подменяя правое незначащее поле адресом правой лапы.
01 3178 04 / 00 0000 07

оверлорд стаи ретранслирует сообщения, устанавливая идентификатор особи, от которой он получил сообщение.
01 3178 04 / 00 01A7 07

оверлорд стаи 01 перед отправкой сообщения во внутреннюю сеть устанавливает адрес стаи, от которой получено сообщение. Покольку адрес полностью заполнен, оверлорд проверяет является ли он всамделишным лордом стаи номер один (или не проверяет, если не знает своего номера) и убедившись заменяет номер входной сети на локальный 0.
00 3178 04 / 02 01A7 07

особь 3178 получает сообщение, затирает свой номер и отсылает сообщение усику. 
00 3178 04 / 02 01A7 07

Усик радуется.
00 0000 04 / 02 01A7 07

Возможно пересылка сообщений между разными уровнями иерархии.